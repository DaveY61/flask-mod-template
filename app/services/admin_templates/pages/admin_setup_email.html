{% extends 'layouts/main.html' %}
{% block title %}Email Setup {{ config.PROJECT_NAME }}{% endblock %}
{% block content %}

<div class="page-header">
  <h2>Email Setup</h2>
</div>

<form method="POST" id="email-setup-form" class="col-md-8">
  <div class="gui-setup-container">
    <div class="gui-setup-row">
      <label for="email_from_address" class="gui-label">From Email Address:</label>
      <div class="gui-input">
        <input type="email" class="form-control form-control-sm" id="email_from_address" name="email_from_address" value="{{ email_config['EMAIL_FROM_ADDRESS'] }}" required>
      </div>
    </div>
    <div class="gui-setup-row">
      <label for="smtp_server" class="gui-label">SMTP Server:</label>
      <div class="gui-input">
        <input type="text" class="form-control form-control-sm" id="smtp_server" name="smtp_server" value="{{ email_config['SMTP_SERVER'] }}" required>
      </div>
    </div>
    <div class="gui-setup-row">
      <label for="smtp_port" class="gui-label">SMTP Port:</label>
      <div class="gui-input">
        <input type="number" class="form-control form-control-sm" id="smtp_port" name="smtp_port" value="{{ email_config['SMTP_PORT'] }}" required>
      </div>
    </div>
    <div class="gui-setup-row">
      <label for="smtp_username" class="gui-label">SMTP Username:</label>
      <div class="gui-input">
        <input type="text" class="form-control form-control-sm" id="smtp_username" name="smtp_username" value="{{ email_config['SMTP_USERNAME'] }}" required>
      </div>
    </div>
    <div class="gui-setup-row">
      <label for="smtp_password" class="gui-label">SMTP Password:</label>
      <div class="gui-input">
        <input type="password" class="form-control form-control-sm" id="smtp_password" name="smtp_password" value="{{ email_config['SMTP_PASSWORD'] }}" required>
      </div>
    </div>
    <div class="gui-setup-row">
      <label for="test_email" class="gui-label">Test Email Address:</label>
      <div class="gui-input">
        <input type="email" class="form-control form-control-sm" id="test_email" name="test_email" value="{{ test_email }}" required>
      </div>
    </div>
  </div>
  <div class="mt-3">
    <button type="submit" name="action" value="update_config" class="btn btn-primary">Update Config</button>
    <button type="submit" name="action" value="test_email" class="btn btn-light btn-outline-secondary">Send Test Email</button>
    <button type="submit" name="action" value="save_and_restart" class="btn btn-warning">Save to .env and Restart</button>
  </div>
</form>

{% endblock %}

{% block scripts %}
<script>
function showAdminSetup(setupType) {
    window.location.href = "{{ url_for('admin.setup_type', setup_type='') }}" + setupType;
}
</script>
{% endblock %}

{% block additional_styles %}
{{ super() }}
<style>
  .gui-setup-container {
    display: table;
    width: 100%;
  }
  .gui-setup-row {
    display: table-row;
  }
  .gui-label {
    display: table-cell;
    white-space: nowrap;
    padding-right: 10px;
    padding-bottom: 15px;
    vertical-align: middle;
  }
  .gui-input {
    display: table-cell;
    width: 100%;
    padding-bottom: 15px;
  }
  .gui-input input[type="text"],
  .gui-input input[type="email"],
  .gui-input input[type="number"],
  .gui-input input[type="password"] {
    width: 250px;
  }
</style>
{% endblock %}